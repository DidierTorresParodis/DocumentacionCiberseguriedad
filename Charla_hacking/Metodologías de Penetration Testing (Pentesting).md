### **8. Metodologías de Penetration Testing**

El **Pentesting** o **Pruebas de Penetración** es una evaluación controlada de la seguridad de un sistema, red o aplicación, donde se simulan ataques reales para identificar vulnerabilidades antes de que puedan ser explotadas por atacantes malintencionados.

Las metodologías de Pentesting ayudan a estructurar estos procesos y garantizar que sean efectivos y repetibles.

---

## **8.1. Fases del Pentesting**

Las pruebas de penetración suelen dividirse en **cinco fases principales**:

### **1️⃣ Recolección de Información (Reconocimiento o Footprinting)**

Objetivo: Obtener la mayor cantidad de datos sobre el objetivo antes de un ataque.

🔹 **OSINT (Open Source Intelligence):** Uso de fuentes abiertas para recopilar información.  
🔹 **Enumeración de subdominios:** Identificar servidores y servicios.  
🔹 **Fingerprinting:** Determinar qué tecnologías y sistemas operativos están en uso.

🛠 **Herramientas:**  
✅ **Shodan** – Escaneo de dispositivos conectados a Internet.  
✅ **theHarvester** – Recolección de correos, subdominios y usuarios.  
✅ **Nmap** – Identificación de servicios y puertos abiertos.

---

### **2️⃣ Escaneo y Enumeración**

Objetivo: Identificar posibles vulnerabilidades en los sistemas objetivo.

🔹 **Escaneo de puertos y servicios activos.**  
🔹 **Enumeración de usuarios, archivos compartidos y bases de datos.**  
🔹 **Detección de versiones de software y vulnerabilidades conocidas.**

🛠 **Herramientas:**  
✅ **Nmap** – Escaneo de puertos y detección de servicios.  
✅ **Nikto** – Análisis de seguridad en servidores web.  
✅ **WPScan** – Escaneo de vulnerabilidades en WordPress.

---

### **3️⃣ Explotación de Vulnerabilidades**

Objetivo: Comprometer el sistema utilizando exploits conocidos o técnicas avanzadas.

🔹 **Ejecutar exploits contra vulnerabilidades detectadas.**  
🔹 **Escalada de privilegios para obtener control total.**  
🔹 **Movilidad lateral dentro de la red objetivo.**

🛠 **Herramientas:**  
✅ **Metasploit** – Plataforma para explotación de sistemas.  
✅ **SQLmap** – Ataques de inyección SQL automatizados.  
✅ **Burp Suite** – Pruebas de seguridad en aplicaciones web.

---

### **4️⃣ Post-Explotación y Mantenimiento del Acceso**

Objetivo: Evaluar el impacto del ataque y mantener el acceso al sistema.

🔹 **Dumping de credenciales y persistencia en el sistema.**  
🔹 **Análisis de archivos sensibles y bases de datos.**  
🔹 **Movimiento lateral para comprometer otros sistemas.**

🛠 **Herramientas:**  
✅ **Mimikatz** – Robo de credenciales en sistemas Windows.  
✅ **Empire** – Framework para post-explotación.  
✅ **PowerShell Empire** – Persistencia y escalada de privilegios en Windows.

---

### **5️⃣ Generación de Reporte y Recomendaciones**

Objetivo: Documentar los hallazgos y ofrecer soluciones de mitigación.

🔹 **Resumen del alcance y metodología utilizada.**  
🔹 **Listado de vulnerabilidades con nivel de criticidad.**  
🔹 **Recomendaciones para corregir las vulnerabilidades detectadas.**

🛠 **Herramientas:**  
✅ **Faraday** – Plataforma de gestión de pruebas de seguridad.  
✅ **Dradis** – Generación de reportes de pentesting.  
✅ **CVE Mitre Database** – Referencia de vulnerabilidades y parches.

---

## **8.2. Tipos de Pruebas de Penetración**

Dependiendo del nivel de acceso y conocimiento previo del sistema, existen diferentes enfoques de Pentesting:

### **🔵 Black Box (Caja Negra)**

🔹 El tester no tiene información previa del sistema.  
🔹 Se simula un ataque real sin conocimiento interno.  
🔹 Útil para evaluar la seguridad perimetral.

### **🟡 Gray Box (Caja Gris)**

🔹 El tester tiene acceso parcial a información del sistema.  
🔹 Se enfoca en probar controles internos y externos.  
🔹 Representa un ataque desde una cuenta comprometida.

### **⚪ White Box (Caja Blanca)**

🔹 El tester tiene acceso completo a información del sistema.  
🔹 Se analiza la seguridad desde dentro, incluyendo código fuente.  
🔹 Útil para auditorías exhaustivas de seguridad.

---

## **8.3. Metodologías de Pruebas de Penetración**

Existen estándares reconocidos a nivel internacional para guiar un Pentesting de manera profesional:

### **📌 OSSTMM (Open Source Security Testing Methodology Manual)**

🔹 Se centra en la evaluación de seguridad operativa.  
🔹 Define métricas objetivas para evaluar la seguridad de una organización.

### **📌 NIST SP 800-115 (National Institute of Standards and Technology)**

🔹 Guía para pruebas de seguridad en sistemas de información.  
🔹 Enfocado en organizaciones gubernamentales y privadas.

### **📌 PTES (Penetration Testing Execution Standard)**

🔹 Define un proceso estructurado para realizar pruebas de penetración.  
🔹 Incluye reconocimiento, escaneo, explotación y reporte de hallazgos.

### **📌 OWASP Testing Guide (Open Web Application Security Project)**

🔹 Metodología específica para pentesting de aplicaciones web.  
🔹 Se centra en vulnerabilidades como inyección SQL, XSS y CSRF.

---

## **8.4. Ejemplo de un Pentest Real**

**Caso:** Un pentester es contratado para evaluar la seguridad de un sitio web de comercio electrónico.

1️⃣ **Reconocimiento:** Se usa **Shodan** y **theHarvester** para recolectar información pública sobre el servidor.  
2️⃣ **Escaneo:** Se usa **Nmap** para identificar puertos abiertos y servicios en ejecución.  
3️⃣ **Explotación:** Se detecta una vulnerabilidad en la versión de Apache y se usa **Metasploit** para explotarla.  
4️⃣ **Post-Explotación:** Se extraen credenciales de usuarios almacenadas en la base de datos.  
5️⃣ **Reporte:** Se genera un informe con recomendaciones para mitigar las vulnerabilidades.

---

## **8.5. Conclusión**

Las pruebas de penetración son esenciales para evaluar la seguridad de sistemas y aplicaciones antes de que los atacantes lo hagan. Seguir una metodología estructurada y utilizar herramientas adecuadas permite detectar vulnerabilidades y fortalecer la ciberseguridad.

